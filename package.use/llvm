# default system toolchain
# almost GNU-free

#
# notes:
#
#   - libcxx requires LLVM/lld to link against compiler-rt and libunwind
#     to remove the libgcc_s dependency; GNU/ld and GNU/gold fail to find
#     the builtin symbols, even though they are there (symbol incompatibility?)
#
#   - toolchain is almost GNU-free, the last remaining bit is GNU/glibc
#     as the C language runtime library; looking forward to musl in the future
#
#   - the toolchain is 32-bit compatible
#
#   - the default linker is set to LLVM/lld using a symlink hack !!
#       ln -s /usr/bin/lld /usr/x86_64-pc-linux-gnu/binutils-bin/2.32/ld.lld
#       binutils-config --linker ld.lld
#     don't forget to update when upgrading binutils
#
#   - LLVM 9.0: the toolchain doesn't depend on GCC anymore and is now
#               fully self contained thanks to compiler-rt containing crt files
#
#

# make backups with: quickpkg sys-libs/llvm-libunwind sys-libs/compiler-rt sys-libs/compiler-rt-sanitizers sys-libs/libcxx sys-libs/libcxxabi sys-devel/llvm sys-devel/clang-common sys-devel/clang-runtime sys-devel/clang dev-util/lldb sys-libs/libomp sys-devel/lld

# mask: sys-libs/libunwind (this is the wrong library)

sys-libs/llvm-libunwind abi_x86_32 static-libs test

sys-libs/compiler-rt clang test
sys-libs/compiler-rt-sanitizers clang test

sys-devel/lld

sys-libs/libcxx abi_x86_32 libcxxabi libunwind static-libs test
sys-libs/libcxxabi abi_x86_32 libunwind static-libs test

sys-devel/llvm -abi_x86_32 xml libffi -gold
=sys-devel/llvm-8.0.1 abi_x86_32 LLVM_TARGETS: -* ARM AArch64 WebAssembly AMDGPU BPF NVPTX PowerPC
=sys-devel/llvm-9.0.0.9999 LLVM_TARGETS: -* X86 WebAssembly

sys-devel/clang-common
sys-devel/clang-runtime -abi_x86_32 libcxx compiler-rt openmp sanitize
sys-devel/clang -abi_x86_32 xml default-compiler-rt default-libcxx
=sys-devel/clang-8.0.1 LLVM_TARGETS: -* ARM AArch64 WebAssembly AMDGPU BPF NVPTX PowerPC
=sys-devel/clang-9.0.0.9999 LLVM_TARGETS: -* X86 WebAssembly
=sys-devel/clang-8.0.1 PYTHON_TARGETS: -* python2_7 PYTHON_SINGLE_TARGET: -* python2_7
=sys-devel/clang-9.0.0.9999 PYTHON_TARGETS: -* python3_7 PYTHON_SINGLE_TARGET: -* python3_7

dev-util/lldb python PYTHON_TARGETS: -* python3_7

# OpenMP runtime library for LLVM/clang compiler
sys-libs/libomp abi_x86_32
